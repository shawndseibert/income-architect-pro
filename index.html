<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Income Architect Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #050505;
            --emerald: #10b981;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg);
            color: #e5e7eb;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }
        .retro-mono { font-family: 'JetBrains Mono', monospace; }
        .glass {
            background: rgba(15, 15, 15, 0.7);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        .glow-text { text-shadow: 0 0 15px rgba(16, 185, 129, 0.4); }
        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button {
            -webkit-appearance: none; margin: 0;
        }
        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-track { background: #050505; }
        ::-webkit-scrollbar-thumb { background: #222; border-radius: 10px; }
    </style>
    <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@19.0.0",
    "react-dom": "https://esm.sh/react-dom@19.0.0",
    "react-dom/client": "https://esm.sh/react-dom@19.0.0/client",
    "recharts": "https://esm.sh/recharts@2.15.0?external=react,react-dom",
    "react/": "https://esm.sh/react@^19.2.3/"
  }
}
</script>
</head>
<body>
    <div id="root"></div>
    <script type="module" src="https://esm.sh/run"></script>
    <script type="text/tsx">
import React, { useState, useMemo, useEffect } from 'react';
import ReactDOM from 'react-dom/client';
import { 
    PieChart, Pie, Cell, ResponsiveContainer, Tooltip as RechartsTooltip, 
    BarChart, Bar, XAxis, YAxis, RadarChart, PolarGrid, PolarAngleAxis, Radar
} from 'recharts';

// --- TYPES ---
enum TimeFrame {
  HOURLY = 'Hourly', DAILY = 'Daily', WEEKLY = 'Weekly', 
  BIWEEKLY = 'Bi-Weekly', MONTHLY = 'Monthly', YEARLY = 'Yearly'
}

interface Expense {
  id: string; label: string; amount: number; 
  frequency: TimeFrame; color: string;
}

// --- CONSTANTS ---
const TAX_BRACKETS = [
  { limit: 11600, rate: 0.10 }, { limit: 47150, rate: 0.12 },
  { limit: 100525, rate: 0.22 }, { limit: 191950, rate: 0.24 },
  { limit: 243725, rate: 0.32 }, { limit: 609350, rate: 0.35 },
  { limit: Infinity, rate: 0.37 }
];

const STATE_TAX_RATES: Record<string, number> = {
  'NONE': 0, 'CA': 0.08, 'NY': 0.06, 'TX': 0, 'FL': 0, 'WA': 0
};

// --- LOGIC ---
const convertToAnnual = (amount: number, tf: TimeFrame) => {
  if (!amount) return 0;
  switch (tf) {
    case TimeFrame.HOURLY: return amount * 8 * 5 * 52;
    case TimeFrame.DAILY: return amount * 5 * 52;
    case TimeFrame.WEEKLY: return amount * 52;
    case TimeFrame.BIWEEKLY: return amount * 26;
    case TimeFrame.MONTHLY: return amount * 12;
    case TimeFrame.YEARLY: return amount;
    default: return 0;
  }
};

const calculateTax = (gross: number) => {
  let tax = 0; let rem = gross; let prev = 0;
  for (const b of TAX_BRACKETS) {
    const taxable = Math.min(rem, b.limit - prev);
    if (taxable <= 0) break;
    tax += taxable * b.rate; rem -= taxable; prev = b.limit;
  }
  return tax;
};

// --- COMPONENTS ---
const StatBox = ({ label, value, color }: any) => (
  <div className="glass p-4 rounded-2xl border-emerald-500/10">
    <span className="text-[9px] uppercase tracking-widest font-black text-neutral-500 block mb-1">{label}</span>
    <div className={`text-xl font-bold retro-mono ${color}`}>${Math.round(value).toLocaleString()}</div>
  </div>
);

const App = () => {
  const [income, setIncome] = useState({ amount: 0, tf: TimeFrame.HOURLY, state: 'NONE', isGross: true });
  const [expenses, setExpenses] = useState<Expense[]>([]);
  const [period, setPeriod] = useState('Month');
  const [chartIdx, setChartIdx] = useState(0);

  useEffect(() => {
    const saved = localStorage.getItem('income_arch_v4');
    if (saved) {
      const p = JSON.parse(saved);
      setIncome(p.income); setExpenses(p.expenses);
    }
  }, []);

  useEffect(() => {
    localStorage.setItem('income_arch_v4', JSON.stringify({ income, expenses }));
  }, [income, expenses]);

  const results = useMemo(() => {
    const annualGross = convertToAnnual(income.amount, income.tf);
    const tax = income.isGross ? (calculateTax(annualGross) + (annualGross * (STATE_TAX_RATES[income.state] || 0))) : 0;
    const expenseTotal = expenses.reduce((a, b) => a + convertToAnnual(b.amount, b.frequency), 0);
    const takeHome = Math.max(0, annualGross - tax - expenseTotal);
    
    const f = period === 'Year' ? 1 : period === 'Month' ? 1/12 : period === 'Week' ? 1/52 : 1/260;
    return {
      takeHome: takeHome * f, gross: annualGross * f, tax: tax * f, exp: expenseTotal * f,
      chartData: [
        { name: 'Liquid', value: takeHome * f, color: '#10b981' },
        { name: 'Tax', value: tax * f, color: '#ef4444' },
        ...expenses.map(e => ({ name: e.label, value: convertToAnnual(e.amount, e.frequency) * f, color: e.color }))
      ].filter(d => d.value > 0)
    };
  }, [income, expenses, period]);

  return (
    <div className="min-h-screen pb-20">
      <nav className="fixed top-0 inset-x-0 glass z-50 px-6 py-4 flex justify-between items-center border-b border-white/5">
        <h1 className="text-xs font-black uppercase tracking-[0.3em] text-white">Income <span className="text-emerald-500">Architect</span></h1>
        <div className="flex bg-neutral-900 rounded-lg p-1">
          {['Year', 'Month', 'Week'].map(p => (
            <button key={p} onClick={() => setPeriod(p)} className={`px-3 py-1 text-[9px] font-black rounded-md ${period === p ? 'bg-emerald-600 text-white' : 'text-neutral-500'}`}>{p[0]}</button>
          ))}
        </div>
      </nav>

      <main className="max-w-6xl mx-auto px-4 pt-24 grid grid-cols-1 lg:grid-cols-12 gap-8">
        <div className="lg:col-span-5 space-y-6 order-2 lg:order-1">
          <section className="glass p-6 rounded-3xl border-emerald-500/10">
            <h3 className="text-[10px] font-black uppercase text-emerald-500/60 mb-4">Revenue</h3>
            <div className="space-y-4">
              <input 
                type="number" value={income.amount || ''} 
                onChange={e => setIncome({...income, amount: parseFloat(e.target.value) || 0})}
                className="w-full bg-neutral-950 border border-neutral-800 rounded-2xl py-4 px-6 text-3xl retro-mono text-white outline-none focus:border-emerald-500/50"
                placeholder="0.00"
              />
              <div className="grid grid-cols-3 gap-2">
                <select value={income.tf} onChange={e => setIncome({...income, tf: e.target.value as TimeFrame})} className="bg-neutral-900 border border-neutral-800 rounded-xl p-3 text-[10px] font-black text-white outline-none">
                  {Object.values(TimeFrame).map(t => <option key={t} value={t}>{t}</option>)}
                </select>
                <button onClick={() => setIncome({...income, isGross: !income.isGross})} className={`rounded-xl text-[10px] font-black ${income.isGross ? 'bg-emerald-600' : 'bg-neutral-800'}`}>{income.isGross ? 'GROSS' : 'NET'}</button>
                <select value={income.state} onChange={e => setIncome({...income, state: e.target.value})} className="bg-neutral-900 border border-neutral-800 rounded-xl p-3 text-[10px] font-black text-white outline-none">
                  <option value="NONE">FED ONLY</option>
                  <option value="CA">CALIFORNIA</option>
                  <option value="NY">NEW YORK</option>
                </select>
              </div>
            </div>
          </section>

          <section className="glass p-6 rounded-3xl border-emerald-500/10">
            <div className="flex justify-between items-center mb-4">
              <h3 className="text-[10px] font-black uppercase text-emerald-500/60">Liabilities</h3>
              <button onClick={() => setExpenses([...expenses, { id: Math.random().toString(), label: 'New Bill', amount: 0, frequency: TimeFrame.MONTHLY, color: `hsl(${Math.random()*360},70%,50%)` }])} className="text-emerald-500 text-[10px] font-black">+ ADD</button>
            </div>
            <div className="space-y-2">
              {expenses.map(ex => (
                <div key={ex.id} className="flex items-center gap-3 glass p-3 rounded-xl">
                  <div className="w-3 h-3 rounded-full shrink-0" style={{backgroundColor: ex.color}} />
                  <input className="bg-transparent border-none text-xs font-bold text-white w-full" value={ex.label} onChange={e => setExpenses(expenses.map(x => x.id === ex.id ? {...x, label: e.target.value} : x))} />
                  <input type="number" className="bg-transparent border-none text-right text-xs retro-mono text-neutral-400 w-20" value={ex.amount || ''} onChange={e => setExpenses(expenses.map(x => x.id === ex.id ? {...x, amount: parseFloat(e.target.value) || 0} : x))} />
                  <button onClick={() => setExpenses(expenses.filter(x => x.id !== ex.id))} className="text-neutral-600 hover:text-red-500">&times;</button>
                </div>
              ))}
            </div>
          </section>
        </div>

        <div className="lg:col-span-7 space-y-6 order-1 lg:order-2">
          <section className="glass rounded-[2.5rem] p-8 border-emerald-500/20 bg-gradient-to-br from-[#0a0a0a] to-black">
            <span className="text-[10px] uppercase font-black text-emerald-500/80">Net Disposable ({period})</span>
            <h2 className="text-6xl md:text-8xl font-black text-white glow-text mt-2 retro-mono">${Math.round(results.takeHome).toLocaleString()}</h2>
            <div className="grid grid-cols-3 gap-4 mt-8 pt-8 border-t border-white/5">
              <StatBox label="Gross" value={results.gross} color="text-neutral-400" />
              <StatBox label="Taxes" value={results.tax} color="text-red-500" />
              <StatBox label="Bills" value={results.exp} color="text-blue-500" />
            </div>
          </section>

          <section className="glass p-6 rounded-[2.5rem] h-[350px]">
             <div className="flex justify-between items-center mb-4">
                <h4 className="text-[10px] font-black uppercase text-emerald-500/60">Analytics</h4>
                <div className="flex gap-1">
                  {[0, 1].map(i => <button key={i} onClick={() => setChartIdx(i)} className={`w-2 h-2 rounded-full ${chartIdx === i ? 'bg-emerald-500 w-4' : 'bg-neutral-800'}`} />)}
                </div>
             </div>
             <ResponsiveContainer width="100%" height="85%">
                {chartIdx === 0 ? (
                  <PieChart>
                    <Pie data={results.chartData} innerRadius={60} outerRadius={85} paddingAngle={5} dataKey="value" stroke="none">
                      {results.chartData.map((e, i) => <Cell key={i} fill={e.color} />)}
                    </Pie>
                    <RechartsTooltip />
                  </PieChart>
                ) : (
                  <BarChart data={results.chartData} layout="vertical">
                    <XAxis type="number" hide />
                    <YAxis dataKey="name" type="category" hide />
                    <Bar dataKey="value" radius={[0, 10, 10, 0]}>
                      {results.chartData.map((e, i) => <Cell key={i} fill={e.color} />)}
                    </Bar>
                    <RechartsTooltip />
                  </BarChart>
                )}
             </ResponsiveContainer>
          </section>
        </div>
      </main>
    </div>
  );
};

ReactDOM.createRoot(document.getElementById('root')!).render(<App />);
    </script>
</body>
</html>